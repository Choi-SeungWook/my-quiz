<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ì˜ì–´ ë¬¸ì¥ í€´ì¦ˆ</title>
    <style>
        body { 
            font-family: -apple-system, sans-serif; 
            text-align: center; 
            padding: 0; 
            margin: 0; 
            background-color: #f8f9fa; 
            height: 100vh; 
            display: flex; 
            flex-direction: column;
            user-select: none;
            /* í„°ì¹˜ ì‹œ ê¹œë¹¡ì„ ë°©ì§€ í•µì‹¬ ì½”ë“œ */
            -webkit-tap-highlight-color: transparent;
        }
        
        /* ì‹¤ì‹œê°„ íƒ€ì´ë¨¸ ìŠ¤íƒ€ì¼ */
        #timer-display {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            z-index: 1000;
        }

        #setup { padding: 80px 20px; }
        .quiz-container { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            padding: 20px;
            cursor: pointer;
        }
        .card { 
            background: white; 
            width: 90%; 
            max-width: 500px; 
            padding: 40px 20px; 
            border-radius: 25px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.08); 
        }
        .kor-text { font-size: 1.5rem; font-weight: bold; color: #333; margin-bottom: 25px; line-height: 1.4; }
        .eng-text { font-size: 1.4rem; color: #28a745; font-weight: 600; min-height: 1.5em; }
        .hint-msg { color: #bbb; font-size: 0.85rem; margin-top: 30px; letter-spacing: -0.5px; }
        .info { font-size: 0.9rem; color: #888; margin-bottom: 15px; }
        
        input { padding: 15px; width: 80%; font-size: 1.1rem; border: 2px solid #eee; border-radius: 12px; margin-bottom: 20px; outline: none; }
        button.start-btn { padding: 15px 45px; font-size: 1.2rem; background: #007bff; color: white; border: none; border-radius: 12px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="timer-display" style="display:none;">00:00</div>

    <div id="setup">
        <h2>ğŸ¯ ì˜ì–´ í€´ì¦ˆ ì„¤ì •</h2>
        <p class="info" id="total-info">ë°ì´í„° í™•ì¸ ì¤‘...</p>
        <input type="text" id="page-input" placeholder="ì¥ ë²ˆí˜¸ (ì˜ˆ: 1, 3-5)">
        <br>
        <button class="start-btn" onclick="startQuiz()">ì‹œì‘í•˜ê¸°</button>
    </div>

    <div id="quiz" class="quiz-container" style="display:none;" onclick="handleScreenTouch()">
        <div class="info" id="progress"></div>
        <div class="card">
            <div class="kor-text" id="kor-text"></div>
            <div id="eng-text-container">
                <div class="eng-text" id="eng-text" style="visibility: hidden;"></div>
            </div>
            <div class="hint-msg" id="hint-msg">í„°ì¹˜í•˜ë©´ ì •ë‹µì´ ë³´ì—¬ìš”</div>
        </div>
    </div>

    <script>
        let allData = [];
        let quizList = [];
        let currentIndex = 0;
        let isShowingAnswer = false;
        let startTime;
        let timerInterval;

        fetch('English_Sentences.txt')
            .then(response => response.text())
            .then(text => {
                const lines = text.split('\n');
                lines.forEach(line => {
                    let cleanLine = line.trim();
                    if (!cleanLine) return;
                    if (cleanLine.includes(']')) cleanLine = cleanLine.split(']').pop().trim();
                    const parts = cleanLine.split(',');
                    if (parts.length >= 3 && !isNaN(parts[0].trim())) {
                        allData.push({ num: parseInt(parts[0].trim()), kor: parts[1].trim(), eng: parts[2].trim() });
                    }
                });
                document.getElementById('total-info').innerText = `âœ… ì´ ${allData.length}ë¬¸ì¥ ë¡œë“œ ì™„ë£Œ`;
            });

        function startTimer() {
            startTime = Date.now();
            document.getElementById('timer-display').style.display = 'block';
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const mins = String(Math.floor(elapsed / 60)).padStart(2, '0');
                const secs = String(elapsed % 60).padStart(2, '0');
                document.getElementById('timer-display').innerText = `${mins}:${secs}`;
            }, 1000);
        }

        function startQuiz() {
            const input = document.getElementById('page-input').value;
            const pages = new Set();
            input.split(',').forEach(p => {
                if (p.includes('-')) {
                    const [start, end] = p.split('-').map(Number);
                    for (let i = Math.min(start, end); i <= Math.max(start, end); i++) pages.add(i);
                } else if (!isNaN(p.trim()) && p.trim() !== "") {
                    pages.add(parseInt(p.trim()));
                }
            });

            quizList = allData.filter(d => pages.has(Math.ceil(d.num / 30)));
            if (quizList.length === 0) return alert('ì¥ ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”!');
            
            quizList.sort(() => Math.random() - 0.5);
            document.getElementById('setup').style.display = 'none';
            document.getElementById('quiz').style.display = 'flex';
            
            startTimer();
            showQuestion();
        }

        function showQuestion() {
            const q = quizList[currentIndex];
            document.getElementById('progress').innerText = `ë¬¸í•­: ${currentIndex + 1} / ${quizList.length}`;
            document.getElementById('kor-text').innerText = q.kor;
            document.getElementById('eng-text').innerText = q.eng;
            document.getElementById('eng-text').style.visibility = 'hidden';
            document.getElementById('hint-msg').innerText = 'í„°ì¹˜í•˜ë©´ ì •ë‹µì´ ë³´ì—¬ìš”';
            isShowingAnswer = false;
        }

        function handleScreenTouch() {
            if (!isShowingAnswer) {
                document.getElementById('eng-text').style.visibility = 'visible';
                document.getElementById('hint-msg').innerText = 'ë‹¤ì‹œ í„°ì¹˜í•˜ë©´ ë‹¤ìŒ ë¬¸ì œ';
                isShowingAnswer = true;
            } else {
                currentIndex++;
                if (currentIndex < quizList.length) {
                    showQuestion();
                } else {
                    clearInterval(timerInterval);
                    const finalTime = document.getElementById('timer-display').innerText;
                    alert(`ğŸ‰ í•™ìŠµ ì™„ë£Œ!\nâ± ì†Œìš” ì‹œê°„: ${finalTime}`);
                    location.reload();
                }
            }
        }
    </script>
</body>
</html>
