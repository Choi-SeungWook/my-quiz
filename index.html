<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì–´ ë¬¸ì¥ í€´ì¦ˆ</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background-color: #f0f2f5; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 500px; margin: 20px auto; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 5px; margin: 5px; }
        input { padding: 10px; width: 80%; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; }
        #answer { display: none; color: #28a745; font-weight: bold; font-size: 1.2em; margin-top: 20px; }
        .info { font-size: 0.9em; color: #666; margin-bottom: 10px; }
    </style>
</head>
<body>
    <h2>ğŸ¯ ì˜ì–´ ë¬¸ì¥ í€´ì¦ˆ</h2>
    <div id="setup">
        <p class="info" id="total-info">íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        <p>í•™ìŠµí•  ì¥ ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”<br>(ì˜ˆ: 1, 3, 5-8)</p>
        <input type="text" id="page-input" placeholder="ì¥ ë²ˆí˜¸ ì…ë ¥">
        <br>
        <button onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘</button>
    </div>

    <div id="quiz" style="display:none;">
        <div class="card">
            <div class="info" id="progress"></div>
            <p id="kor-text" style="font-size: 1.3em;"></p>
            <div id="answer"></div>
            <br>
            <button id="next-btn" onclick="handleNext()">ì •ë‹µ í™•ì¸</button>
        </div>
    </div>

    <script>
        let allData = [];
        let quizList = [];
        let currentIndex = 0;
        let isShowingAnswer = false;

        // íŒŒì¼ ì½ê¸°
        fetch('English_Sentences.txt')
            .then(response => response.text())
            .then(text => {
                const lines = text.split('\n');
                lines.forEach(line => {
                    let cleanLine = line.trim();
                    if (!cleanLine) return;
                    if (cleanLine.includes(']')) cleanLine = cleanLine.split(']').pop().trim();
                    const parts = cleanLine.split(',');
                    if (parts.length >= 3 && !isNaN(parts[0])) {
                        allData.push({ num: parseInt(parts[0]), kor: parts[1], eng: parts[2] });
                    }
                });
                document.getElementById('total-info').innerText = `âœ… ì´ ${allData.length}ê°œ ë¬¸ì¥ ë¡œë“œ ì™„ë£Œ`;
            });

        function startQuiz() {
            const input = document.getElementById('page-input').value;
            const pages = new Set();
            input.split(',').forEach(p => {
                if (p.includes('-')) {
                    const [start, end] = p.split('-').map(Number);
                    for (let i = Math.min(start, end); i <= Math.max(start, end); i++) pages.add(i);
                } else if (!isNaN(p.trim())) {
                    pages.add(parseInt(p.trim()));
                }
            });

            quizList = allData.filter(d => {
                const pNum = Math.ceil(d.num / 30);
                return pages.has(pNum);
            });

            if (quizList.length === 0) return alert('í•´ë‹¹í•˜ëŠ” ì¥ì´ ì—†ìŠµë‹ˆë‹¤!');
            quizList.sort(() => Math.random() - 0.5);
            
            document.getElementById('setup').style.display = 'none';
            document.getElementById('quiz').style.display = 'block';
            showQuestion();
        }

        function showQuestion() {
            const q = quizList[currentIndex];
            document.getElementById('progress').innerText = `ì§„í–‰: ${currentIndex + 1}/${quizList.length}`;
            document.getElementById('kor-text').innerText = `ğŸ‘‰ ${q.kor}`;
            document.getElementById('answer').innerText = `ğŸ“– ${q.eng}`;
            document.getElementById('answer').style.display = 'none';
            document.getElementById('next-btn').innerText = 'ì •ë‹µ í™•ì¸';
            isShowingAnswer = false;
        }

        function handleNext() {
            if (!isShowingAnswer) {
                document.getElementById('answer').style.display = 'block';
                document.getElementById('next-btn').innerText = 'ë‹¤ìŒ ë¬¸ì œ';
                isShowingAnswer = true;
            } else {
                currentIndex++;
                if (currentIndex < quizList.length) {
                    showQuestion();
                } else {
                    alert('ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!');
                    location.reload();
                }
            }
        }
    </script>
</body>
</html>