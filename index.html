<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì˜ì–´ ë¬¸ì¥ í€´ì¦ˆ</title>
    <style>
        /* í°ì—ì„œ ë³´ê¸° í¸í•˜ê²Œ ì „ì²´ì ì¸ í¬ê¸°ë¥¼ í‚¤ì› ìŠµë‹ˆë‹¤ */
        body { 
            font-family: -apple-system, sans-serif; 
            text-align: center; 
            padding: 0; 
            margin: 0; 
            background-color: #f8f9fa; 
            height: 100vh; 
            display: flex; 
            flex-direction: column;
            user-select: none; /* í…ìŠ¤íŠ¸ ì„ íƒ ë°©ì§€ */
        }
        #setup { padding: 50px 20px; }
        .quiz-container { 
            flex: 1; 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            padding: 20px;
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•œ ëŠë‚Œ ì£¼ê¸° */
        }
        .card { 
            background: white; 
            width: 90%; 
            max-width: 500px; 
            padding: 40px 20px; 
            border-radius: 20px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
        }
        h2 { color: #333; }
        .kor-text { font-size: 1.5rem; font-weight: bold; color: #007bff; margin-bottom: 20px; line-height: 1.4; }
        .eng-text { font-size: 1.4rem; color: #28a745; font-weight: 600; min-height: 1.5em; }
        .hint-msg { color: #aaa; font-size: 0.9rem; margin-top: 30px; }
        .info { font-size: 0.9rem; color: #666; margin-bottom: 10px; }
        input { padding: 15px; width: 80%; font-size: 1.1rem; border: 2px solid #ddd; border-radius: 10px; margin-bottom: 20px; }
        button.start-btn { padding: 15px 40px; font-size: 1.2rem; background: #007bff; color: white; border: none; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div id="setup">
        <h2>ğŸ¯ ì˜ì–´ í€´ì¦ˆ ì„¤ì •</h2>
        <p class="info" id="total-info">íŒŒì¼ ë¡œë”© ì¤‘...</p>
        <input type="text" id="page-input" placeholder="ì¥ ë²ˆí˜¸ (ì˜ˆ: 1, 3-5)">
        <br>
        <button class="start-btn" onclick="startQuiz()">í€´ì¦ˆ ì‹œì‘</button>
    </div>

    <div id="quiz" class="quiz-container" style="display:none;" onclick="handleScreenTouch()">
        <div class="info" id="progress"></div>
        <div class="card">
            <div class="kor-text" id="kor-text"></div>
            <div class="eng-text" id="eng-text" style="visibility: hidden;"></div>
            <div class="hint-msg" id="hint-msg">í™”ë©´ì„ í„°ì¹˜í•˜ë©´ ì •ë‹µì´ ë³´ì—¬ìš”</div>
        </div>
    </div>

    <script>
        let allData = [];
        let quizList = [];
        let currentIndex = 0;
        let isShowingAnswer = false;

        // íŒŒì¼ ì½ê¸°
        fetch('English_Sentences.txt')
            .then(response => response.text())
            .then(text => {
                const lines = text.split('\n');
                lines.forEach(line => {
                    let cleanLine = line.trim();
                    if (!cleanLine) return;
                    if (cleanLine.includes(']')) cleanLine = cleanLine.split(']').pop().trim();
                    const parts = cleanLine.split(',');
                    if (parts.length >= 3 && !isNaN(parts[0].trim())) {
                        allData.push({ num: parseInt(parts[0].trim()), kor: parts[1].trim(), eng: parts[2].trim() });
                    }
                });
                document.getElementById('total-info').innerText = `âœ… ì´ ${allData.length}ê°œ ë¬¸ì¥ ì¤€ë¹„ë¨`;
            });

        function startQuiz() {
            const input = document.getElementById('page-input').value;
            const pages = new Set();
            input.split(',').forEach(p => {
                if (p.includes('-')) {
                    const [start, end] = p.split('-').map(Number);
                    for (let i = Math.min(start, end); i <= Math.max(start, end); i++) pages.add(i);
                } else if (!isNaN(p.trim()) && p.trim() !== "") {
                    pages.add(parseInt(p.trim()));
                }
            });

            quizList = allData.filter(d => pages.has(Math.ceil(d.num / 30)));

            if (quizList.length === 0) return alert('ì¥ ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”! (1~20)');
            quizList.sort(() => Math.random() - 0.5);
            
            document.getElementById('setup').style.display = 'none';
            document.getElementById('quiz').style.display = 'flex';
            showQuestion();
        }

        function showQuestion() {
            const q = quizList[currentIndex];
            document.getElementById('progress').innerText = `ì§„í–‰: ${currentIndex + 1} / ${quizList.length}`;
            document.getElementById('kor-text').innerText = `ğŸ‘‰ ${q.kor}`;
            document.getElementById('eng-text').innerText = q.eng;
            document.getElementById('eng-text').style.visibility = 'hidden';
            document.getElementById('hint-msg').innerText = 'í™”ë©´ì„ í„°ì¹˜í•˜ë©´ ì •ë‹µì´ ë³´ì—¬ìš”';
            isShowingAnswer = false;
        }

        // í™”ë©´ ì–´ë””ë“  í„°ì¹˜í–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
        function handleScreenTouch() {
            if (!isShowingAnswer) {
                // ì •ë‹µ ë³´ì—¬ì£¼ê¸°
                document.getElementById('eng-text').style.visibility = 'visible';
                document.getElementById('hint-msg').innerText = 'í•œ ë²ˆ ë” í„°ì¹˜í•˜ë©´ ë‹¤ìŒ ë¬¸ì œë¡œ!';
                isShowingAnswer = true;
            } else {
                // ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°€ê¸°
                currentIndex++;
                if (currentIndex < quizList.length) {
                    showQuestion();
                } else {
                    alert('ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤!');
                    location.reload();
                }
            }
        }
    </script>
</body>
</html>
